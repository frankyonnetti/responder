<!DOCTYPE html>
<html>
  <head>
    <title>Responder</title>
  </head>

  <link href="./css/styles.css" media="all" rel="stylesheet">

  <script>
    window.$ = window.jQuery = require('./node_modules/jquery/dist/jquery.min.js');
    require('./js/menus.js');
    require('./js/scripts.js');

    onload = function() {

      // show webview loading...
      var webview = document.getElementById('foo');
      var indicator = document.querySelector('.indicator');

      var loadstart = function() {
        indicator.innerHTML = '<img src="img/loader.gif" width="16" height="16">';
      };
      var loadstop = function() {
        indicator.innerHTML = '';
      };
      webview.addEventListener('did-start-loading', loadstart);
      webview.addEventListener('did-stop-loading', loadstop);

      // Get URL from clicked link in webview.
      webview.addEventListener('dom-ready', function() {
        var clickedAnchor = webview.getUrl();
        document.getElementById('responder-url').value = clickedAnchor;
      });

      // http://stackoverflow.com/questions/16048084/jquery-detect-textbox-value-change-not-based-on-user-input
      // var $ = require('jquery');
      // var $myText = $("input#responder-url");

      // $myText.data("value", $myText.val());

      // setInterval(function() {
      //   var data = $myText.data("value"),
      //       val = $myText.val();

      //   if (data !== val) {
      //     $myText.data("value", val);

      //     var responderURL = $('input#responder-url').val();
      //     $('.frame').each(function() {
      //       $(this).attr('src', responderURL);
      //       localStorage.setItem('urlItem', responderURL);
      //     });

      //   }
      // }, 100);

      // show inspector.
      var a = document.getElementById('show');
      a.onclick = showCode;
    };

    // show inspector.
    function showCode() {
      var webview = document.getElementById('foo');
      webview.inspectElement(0, 0); // x, y
    }

  </script>

  <body>

    <header>
      <ul>
        <li class="urls"><i class="fa fa-globe"></i>
          <ul id="url-submission">
            <lh><input id="responder-url" type="text" placeholder="Enter URL"></lh>
          </ul>
        </li>
        <li><i class="fa fa-plus-circle"></i></li>
      </ul>

      <!-- <button class="button-load"><i class="fa fa-refresh"></i></button>  -->
      <!-- <button class="button-clear">C</button> -->
    </header>

    <main><div class="main-container">
      <div id="device-area">

        <div class="device-window" style="width:332px;">
          <div class="webview-info">
            iPhone 5
            <span class="indicator"></span>
            <span class="actions">
              <a id="show" class="web-inspector" href="#test">Web Inspector</a>
              <a class="close-webview" href="#"> 320 x 568</a>
            </span>
          </div>
          <webview id="foo" class="frame" src="" style="width:332px; height:568px;"></webview>
        </div>

        <div class="device-window" style="width:387px;">
          <div class="webview-info">
            iPhone 6
            <span class="indicator"></span>
            <span class="actions">
              <a id="show" class="web-inspector" href="#test">Web Inspector</a>
              <a class="close-webview" href="#"> 375 x 627</a>
            </span>
          </div>
          <webview class="frame" src="" style="width:387px; height:627px;"></webview>
        </div>

        <div class="device-window" style="width:426px;">
          <div class="webview-info">
            iPhone 6 Plus
            <span class="indicator"></span>
            <span class="actions">
              <a id="show" class="web-inspector" href="#test">Web Inspector</a>
              <a class="close-webview" href="#"> 414 x 736</a>
            </span>
          </div>
          <webview class="frame" src="" style="width:426px; height:736px;"></webview>
        </div>

        <br style="clear:both;">

      </div>
    </div></main>

    <!-- <p>We are using node <script>document.write(process.versions.node)</script>,<br>
    Chrome <script>document.write(process.versions.chrome)</script>,<br>
    and Electron <script>document.write(process.versions.electron)</script>.</p> -->

    <script src="http://localhost:23476/livereload.js"></script>

  </body>
</html>
